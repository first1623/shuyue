<!--pages/flipbook/flipbook.wxml-->
<view class="flipbook-container">
  <!-- åŠ è½½é®ç½© -->
  <view class="loading-mask" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <view class="loading-text">æ­£åœ¨åŠ è½½...</view>
  </view>

  <!-- ä¹¦æœ¬å®¹å™¨ -->
  <view class="book-stage" wx:if="{{!loading && images.length > 0}}">
    
    <!-- å½“å‰é¡µ -->
    <view class="current-page" wx:if="{{!isFlipping}}">
      <image 
        src="{{images[currentIndex]}}" 
        mode="widthFix" 
        class="page-image"
      ></image>
    </view>
    
    <!-- ç¿»é¡µåŠ¨ç”»å±‚ -->
    <view class="flip-container" wx:if="{{isFlipping}}">
      <!-- ç¿»å‡ºçš„é¡µï¼ˆä¸‹ä¸€é¡µï¼‰ -->
      <view 
        class="flipping-page next-page" 
        style="transform: rotateY({{flipAngle}}deg);"
      >
        <image 
          src="{{images[nextIndex]}}" 
          mode="widthFix" 
          class="page-image"
        ></image>
        <view class="page-shadow"></view>
      </view>
      
      <!-- è¢«ç¿»èµ°çš„é¡µï¼ˆå½“å‰é¡µï¼‰ -->
      <view 
        class="flipping-page current-page-flip" 
        style="transform: rotateY({{currentAngle}}deg);"
        wx:if="{{showCurrentFlip}}"
      >
        <image 
          src="{{images[currentIndex]}}" 
          mode="widthFix" 
          class="page-image"
        ></image>
        <view class="page-shadow-flip"></view>
      </view>
    </view>
    
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{!loading && images.length === 0}}">
    <text style="font-size: 80rpx; margin-bottom: 20rpx;">ğŸ“š</text>
    <text>æš‚æ— å†…å®¹</text>
  </view>

  <!-- ç‚¹å‡»åŒºåŸŸ -->
  <view class="click-area area-left" bindtap="prevPage" wx:if="{{currentIndex > 0}}"></view>
  <view class="click-area area-right" bindtap="nextPage" wx:if="{{currentIndex < images.length - 1}}"></view>

  <!-- åº•éƒ¨å·¥å…·æ  -->
  <view class="toolbar" wx:if="{{images.length > 0}}">
    <view class="page-info">
      <text>{{currentIndex + 1}} / {{images.length}}</text>
    </view>
  </view>

  <!-- æç¤º -->
  <view class="hint" wx:if="{{showHint}}">
    <text>â† ç‚¹å‡»å·¦å³ç¿»é¡µ â†’</text>
  </view>

  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-btn" bindtap="goBack">
    <text>â† è¿”å›</text>
  </view>
</view>
